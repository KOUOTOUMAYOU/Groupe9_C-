<Window x:Class="KeyceWordEditor.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="KeyceWordEditor - Éditeur de texte professionnel" 
        Height="800" Width="1200"
        WindowStartupLocation="CenterScreen">

    <Window.Resources>
        <Style x:Key="MenuButtonStyle" TargetType="Button">
            <Setter Property="Margin" Value="2"/>
            <Setter Property="Padding" Value="8,4"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
        </Style>
    </Window.Resources>

    <DockPanel>
        <!-- Menu Principal -->
        <Menu DockPanel.Dock="Top" Background="#F5F5F5">
            <MenuItem Header="Fichier">
                <MenuItem Header="Nouveau" Click="NewDocument_Click"/>
                <MenuItem Header="Ouvrir..." Click="OpenDocument_Click"/>
                <MenuItem Header="Enregistrer" Click="SaveDocument_Click"/>
                <MenuItem Header="Enregistrer sous..." Click="SaveAsDocument_Click"/>
                <Separator/>
                <MenuItem Header="Exporter en DOCX" Click="ExportToDocx_Click"/>
                <MenuItem Header="Exporter en PDF" Click="ExportToPdf_Click"/>
                <Separator/>
                <MenuItem Header="Aperçu avant impression" Click="PrintPreview_Click"/>
                <MenuItem Header="Imprimer..." Click="PrintDocument_Click"/>
                <Separator/>
                <MenuItem Header="Quitter" Click="Exit_Click"/>
            </MenuItem>

            <MenuItem Header="Édition">
                <MenuItem Header="Annuler" Click="Undo_Click"/>
                <MenuItem Header="Restaurer" Click="Redo_Click"/>
                <Separator/>
                <MenuItem Header="Couper" Click="Cut_Click"/>
                <MenuItem Header="Copier" Click="Copy_Click"/>
                <MenuItem Header="Coller" Click="Paste_Click"/>
                <Separator/>
                <MenuItem Header="Rechercher et Remplacer" Click="FindReplace_Click"/>
                <MenuItem Header="Sélectionner tout" Click="SelectAll_Click"/>
            </MenuItem>

            <MenuItem Header="Affichage">
                <MenuItem Header="Zoom avant" Click="ZoomIn_Click"/>
                <MenuItem Header="Zoom arrière" Click="ZoomOut_Click"/>
                <MenuItem Header="Zoom 100%" Click="ZoomReset_Click"/>
                <Separator/>
                <MenuItem x:Name="PageLayoutMenu" Header="Mode Page" Click="PageLayout_Click" IsCheckable="True" IsChecked="True"/>
                <MenuItem x:Name="DraftLayoutMenu" Header="Mode Brouillon" Click="DraftLayout_Click" IsCheckable="True"/>
            </MenuItem>

            <MenuItem Header="Insertion">
                <MenuItem Header="Image..." Click="InsertImage_Click"/>
                <MenuItem Header="Tableau..." Click="InsertTable_Click"/>
                <MenuItem Header="Formes" Click="InsertShape_Click"/>
                <Separator/>
                <MenuItem Header="Nouvelle Page" Click="AddPage_Click"/>
                <MenuItem Header="Saut de page" Click="InsertPageBreak_Click"/>
                <MenuItem Header="Numérotation" Click="InsertNumbering_Click"/>
            </MenuItem>

            <MenuItem Header="Format">
                <MenuItem Header="Couleur du texte" Click="AdvancedFontColor_Click"/>
                <MenuItem Header="Couleur de fond" Click="AdvancedBackgroundColor_Click"/>
                <MenuItem Header="Surligneur" Click="AdvancedHighlight_Click"/>
            </MenuItem>

            <MenuItem Header="Outils">
                <MenuItem Header="Orthographe et Grammaire" Click="SpellCheck_Click"/>
                <MenuItem Header="Compteur de mots" Click="WordCount_Click"/>
                <MenuItem Header="Assistant IA" Click="AITools_Click"/>
                <MenuItem Header="Dictée vocale" Click="VoiceDictation_Click"/>
            </MenuItem>
        </Menu>

        <!-- Barre d'outils Rapide -->
        <ToolBarTray DockPanel.Dock="Top" Background="White">
            <!-- Barre d'outils Fichier -->
            <ToolBar>
                <Button ToolTip="Nouveau" Click="NewDocument_Click" Style="{StaticResource MenuButtonStyle}">
                    <TextBlock Text="📄"/>
                </Button>
                <Button ToolTip="Ouvrir" Click="OpenDocument_Click" Style="{StaticResource MenuButtonStyle}">
                    <TextBlock Text="📂"/>
                </Button>
                <Button ToolTip="Enregistrer" Click="SaveDocument_Click" Style="{StaticResource MenuButtonStyle}">
                    <TextBlock Text="💾"/>
                </Button>
                <Separator/>
                <Button ToolTip="Imprimer" Click="PrintDocument_Click" Style="{StaticResource MenuButtonStyle}">
                    <TextBlock Text="⎙"/>
                </Button>
            </ToolBar>

            <!-- Barre d'outils Édition -->
            <ToolBar>
                <Button ToolTip="Annuler" Click="Undo_Click" Style="{StaticResource MenuButtonStyle}">
                    <TextBlock Text="↶"/>
                </Button>
                <Button ToolTip="Restaurer" Click="Redo_Click" Style="{StaticResource MenuButtonStyle}">
                    <TextBlock Text="↷"/>
                </Button>
                <Separator/>
                <Button ToolTip="Couper" Click="Cut_Click" Style="{StaticResource MenuButtonStyle}">
                    <TextBlock Text="✂️"/>
                </Button>
                <Button ToolTip="Copier" Click="Copy_Click" Style="{StaticResource MenuButtonStyle}">
                    <TextBlock Text="📋"/>
                </Button>
                <Button ToolTip="Coller" Click="Paste_Click" Style="{StaticResource MenuButtonStyle}">
                    <TextBlock Text="📝"/>
                </Button>
            </ToolBar>

            <!-- Barre d'outils Formatage -->
            <ToolBar>
                <!-- Polices -->
                <ComboBox x:Name="FontFamilyComboBox" Width="120" ToolTip="Police" SelectionChanged="FontFamily_SelectionChanged"/>
                <ComboBox x:Name="FontSizeComboBox" Width="50" ToolTip="Taille" SelectionChanged="FontSize_SelectionChanged">
                    <ComboBoxItem Content="8"/>
                    <ComboBoxItem Content="9"/>
                    <ComboBoxItem Content="10"/>
                    <ComboBoxItem Content="11"/>
                    <ComboBoxItem Content="12" IsSelected="True"/>
                    <ComboBoxItem Content="14"/>
                    <ComboBoxItem Content="16"/>
                    <ComboBoxItem Content="18"/>
                    <ComboBoxItem Content="20"/>
                    <ComboBoxItem Content="24"/>
                    <ComboBoxItem Content="28"/>
                    <ComboBoxItem Content="32"/>
                    <ComboBoxItem Content="36"/>
                </ComboBox>
                <Separator/>

                <!-- Style de texte -->
                <Button ToolTip="Gras" Click="Bold_Click" Style="{StaticResource MenuButtonStyle}">
                    <TextBlock Text="B" FontWeight="Bold"/>
                </Button>
                <Button ToolTip="Italique" Click="Italic_Click" Style="{StaticResource MenuButtonStyle}">
                    <TextBlock Text="I" FontStyle="Italic"/>
                </Button>
                <Button ToolTip="Souligné" Click="Underline_Click" Style="{StaticResource MenuButtonStyle}">
                    <TextBlock Text="S" TextDecorations="Underline"/>
                </Button>
                <Button ToolTip="Barré" Click="Strikethrough_Click" Style="{StaticResource MenuButtonStyle}">
                    <TextBlock Text="S" TextDecorations="Strikethrough"/>
                </Button>
                <Button ToolTip="Surligner" Click="Highlight_Click" Style="{StaticResource MenuButtonStyle}">
                    <TextBlock Text="🎨"/>
                </Button>
                <Separator/>

                <!-- Couleurs -->
                <Button x:Name="FontColorButton" ToolTip="Couleur du texte" Click="FontColor_Click" Style="{StaticResource MenuButtonStyle}">
                    <TextBlock Text="A" Foreground="Black"/>
                </Button>
                <Button x:Name="BackgroundColorButton" ToolTip="Couleur de fond" Click="BackgroundColor_Click" Style="{StaticResource MenuButtonStyle}">
                    <TextBlock Text="🖍️"/>
                </Button>
                <Separator/>

                <!-- Alignement -->
                <Button ToolTip="Aligner à gauche" Click="AlignLeft_Click" Style="{StaticResource MenuButtonStyle}">
                    <TextBlock Text="⫤"/>
                </Button>
                <Button ToolTip="Centrer" Click="AlignCenter_Click" Style="{StaticResource MenuButtonStyle}">
                    <TextBlock Text="☰"/>
                </Button>
                <Button ToolTip="Aligner à droite" Click="AlignRight_Click" Style="{StaticResource MenuButtonStyle}">
                    <TextBlock Text="⫦"/>
                </Button>
                <Button ToolTip="Justifier" Click="AlignJustify_Click" Style="{StaticResource MenuButtonStyle}">
                    <TextBlock Text="☲"/>
                </Button>
                <Separator/>

                <!-- Styles -->
                <ComboBox x:Name="StyleComboBox" Width="120" ToolTip="Styles" SelectionChanged="Style_SelectionChanged">
                    <ComboBoxItem Content="Normal"/>
                    <ComboBoxItem Content="Titre 1"/>
                    <ComboBoxItem Content="Titre 2"/>
                    <ComboBoxItem Content="Titre 3"/>
                    <ComboBoxItem Content="Citation"/>
                    <ComboBoxItem Content="Code"/>
                </ComboBox>
            </ToolBar>

            <!-- Barre d'outils Pages et Export -->
            <ToolBar>
                <Button ToolTip="Nouvelle page" Click="AddPage_Click" Style="{StaticResource MenuButtonStyle}">
                    <TextBlock Text="📄➕"/>
                </Button>
                <Button ToolTip="Saut de page" Click="InsertPageBreak_Click" Style="{StaticResource MenuButtonStyle}">
                    <TextBlock Text="⎆"/>
                </Button>
                <Separator/>
                <Button ToolTip="Couleur du texte" Click="AdvancedFontColor_Click" Style="{StaticResource MenuButtonStyle}">
                    <TextBlock Text="A" Foreground="Red"/>
                </Button>
                <Button ToolTip="Couleur de fond" Click="AdvancedBackgroundColor_Click" Style="{StaticResource MenuButtonStyle}">
                    <TextBlock Text="🖍️" Background="Yellow"/>
                </Button>
                <Button ToolTip="Surligneur" Click="AdvancedHighlight_Click" Style="{StaticResource MenuButtonStyle}">
                    <TextBlock Text="🖊️"/>
                </Button>
                <Separator/>
                <Button ToolTip="Exporter en DOCX" Click="ExportToDocx_Click" Style="{StaticResource MenuButtonStyle}">
                    <TextBlock Text="📝DOCX"/>
                </Button>
                <Button ToolTip="Exporter en PDF" Click="ExportToPdf_Click" Style="{StaticResource MenuButtonStyle}">
                    <TextBlock Text="📄PDF"/>
                </Button>
            </ToolBar>
        </ToolBarTray>

        <!-- Zone d'édition principale avec règles -->
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="30"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="30"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Règle horizontale -->
            <Canvas x:Name="HorizontalRuler" Grid.Row="0" Grid.Column="1" Background="#F0F0F0" 
                    Height="30" ClipToBounds="True">
                <Line X1="0" Y1="29" X2="2000" Y2="29" Stroke="DarkGray" StrokeThickness="1"/>
            </Canvas>

            <!-- Règle verticale -->
            <Canvas x:Name="VerticalRuler" Grid.Row="1" Grid.Column="0" Background="#F0F0F0" 
                    Width="30" ClipToBounds="True">
                <Line X1="29" Y1="0" X2="29" Y2="2000" Stroke="DarkGray" StrokeThickness="1"/>
            </Canvas>

            <!-- Coin supérieur gauche -->
            <Border Grid.Row="0" Grid.Column="0" Background="#E0E0E0" BorderBrush="DarkGray" 
                    BorderThickness="0,0,1,1"/>

            <!-- Zone d'édition -->
            <ScrollViewer x:Name="MainScrollViewer" Grid.Row="1" Grid.Column="1" 
                         VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto"
                         ScrollChanged="MainScrollViewer_ScrollChanged">
                <StackPanel x:Name="PagesContainer" HorizontalAlignment="Center">
                    <Border x:Name="PageContainer" BorderBrush="#CCCCCC" BorderThickness="1" Background="White" 
                            Margin="20" Padding="40" Width="816" Height="1056">
                        <RichTextBox x:Name="Editor" 
                                    SpellCheck.IsEnabled="True"
                                    AcceptsReturn="True"
                                    AcceptsTab="True"
                                    VerticalScrollBarVisibility="Visible"
                                    BorderThickness="0"
                                    FontSize="12"
                                    FontFamily="Calibri">
                            <RichTextBox.Resources>
                                <Style TargetType="Paragraph">
                                    <Setter Property="Margin" Value="0"/>
                                    <Setter Property="TextAlignment" Value="Left"/>
                                </Style>
                            </RichTextBox.Resources>
                        </RichTextBox>
                    </Border>
                </StackPanel>
            </ScrollViewer>
        </Grid>

        <!-- Barre de statut -->
        <StatusBar DockPanel.Dock="Bottom" Background="#E1E1E1">
            <StatusBarItem>
                <TextBlock x:Name="StatusText" Text="Prêt" Margin="5,0"/>
            </StatusBarItem>
            <Separator/>
            <StatusBarItem>
                <TextBlock x:Name="PageInfoText" Text="Page 1" Margin="5,0"/>
            </StatusBarItem>
            <Separator/>
            <StatusBarItem>
                <TextBlock x:Name="WordCountText" Text="Mots: 0" Margin="5,0"/>
            </StatusBarItem>
            <Separator/>
            <StatusBarItem>
                <TextBlock x:Name="CharCountText" Text="Caractères: 0" Margin="5,0"/>
            </StatusBarItem>
            <Separator/>
            <StatusBarItem>
                <TextBlock x:Name="ZoomText" Text="100%" Margin="5,0"/>
            </StatusBarItem>
            <Separator/>
            <StatusBarItem>
                <Slider x:Name="ZoomSlider" Width="100" Minimum="25" Maximum="500" Value="100" 
                       ValueChanged="ZoomSlider_ValueChanged" TickFrequency="25"/>
            </StatusBarItem>
            <StatusBarItem>
                <StackPanel Orientation="Horizontal">
                    <Button Content="-" Click="ZoomOut_Click" Width="20" Margin="2"/>
                    <Button Content="+" Click="ZoomIn_Click" Width="20" Margin="2"/>
                    <Button Content="100%" Click="ZoomReset_Click" Width="40" Margin="2"/>
                </StackPanel>
            </StatusBarItem>
        </StatusBar>
    </DockPanel>
</Window>